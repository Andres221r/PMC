<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Comando Phantom</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron&family=Roboto&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(180deg,#0d1117,#1a2027);
      color: #eee;
      max-width: 800px;
      margin: auto;
      padding: 20px;
      animation: fadeInBody 1s ease-in;
    }
    @keyframes fadeInBody {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    h1 {
      font-family: 'Orbitron', sans-serif;
      text-align: center;
    }
    section {
      margin-bottom: 20px;
      background: rgba(255,255,255,0.05);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    button {
      margin: 5px;
      background: #1f6feb;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      transition: transform 0.2s, background 0.3s;
    }
    button:hover { transform: scale(1.05); background: #388bfd; }
    .fade-in {
      animation: fadeIn 0.5s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <h1>Comando Phantom &mdash; Simulador de PMC</h1>
  <section id="menu">
    <button id="newBtn">Nuevo Juego</button>
    <button id="loadBtn">Cargar Juego</button>
    <button id="saveBtn">Guardar Juego</button>
  </section>
  <section id="info"></section>
  <section id="roster"></section>
  <section id="contracts"></section>
  <section id="logs"></section>

<script>
let game = {
  credits: 10000,
  reputation: 0,
  soldiers: [],
  contracts: [],
  logs: []
};

function log(msg) {
  game.logs.push(msg);
  const logsEl = document.getElementById('logs');
  logsEl.innerHTML =
    '<h2>Registro</h2><pre class="fade-in">' + game.logs.join('\n') + '</pre>';
}

function renderRoster() {
  let html = '<h2>Personal</h2>';
  html += '<button onclick="hireSoldier()">Contratar Soldado</button>';
  if (game.soldiers.length === 0) {
    html += '<p>No hay soldados.</p>';
  } else {
    html += '<ul>' + game.soldiers.map((s, i) =>
      '<li>' + s.name + ' (' + s.rank +
      ', habilidad ' + s.skill +
      ') <button onclick="dismissSoldier(' + i + ')">Despedir</button></li>'
    ).join('') + '</ul>';
  }
  const rosterEl = document.getElementById('roster');
  rosterEl.innerHTML = html;
  rosterEl.classList.add('fade-in');
  setTimeout(() => rosterEl.classList.remove('fade-in'), 500);
}

function renderContracts() {
  let html = '<h2>Contratos Disponibles</h2>';
  html += '<button onclick="createContract()">Nuevo Contrato</button>';
  if (game.contracts.length === 0) {
    html += '<p>No hay contratos.</p>';
  } else {
    html += '<ul>' + game.contracts.map((c, i) =>
      '<li>' + c.name + ' (riesgo ' + c.risk +
      ', recompensa $' + c.reward +
      ') <button onclick="acceptContract(' + i + ')">Aceptar</button></li>'
    ).join('') + '</ul>';
  }
  const contractsEl = document.getElementById('contracts');
  contractsEl.innerHTML = html;
  contractsEl.classList.add('fade-in');
  setTimeout(() => contractsEl.classList.remove('fade-in'), 500);
}

function renderInfo() {
  const infoEl = document.getElementById('info');
  infoEl.innerHTML =
    '<p>Créditos: $' + game.credits +
    ' | Reputación: ' + game.reputation + '</p>';
  infoEl.classList.add('fade-in');
  setTimeout(() => infoEl.classList.remove('fade-in'), 500);
}

function newGame() {
  if (confirm('¿Comenzar nuevo juego?')) {
    game = { credits: 10000, reputation: 0, soldiers: [], contracts: [], logs: [] };
    renderAll();
    log('Nuevo juego iniciado.');
  }
}

function saveGame() {
  localStorage.setItem('comandoPhantom', JSON.stringify(game));
  log('Juego guardado.');
}

function loadGame() {
  const data = localStorage.getItem('comandoPhantom');
  if (data) {
    game = JSON.parse(data);
    renderAll();
    log('Juego cargado.');
  } else {
    alert('No hay partida guardada.');
  }
}

function hireSoldier() {
  const name = prompt('Nombre del soldado:');
  if (!name) return;
  const rank = prompt('Rango del soldado:', 'Soldado');
  const skill = parseInt(prompt('Habilidad (1-100):', '50')) || 50;
  game.soldiers.push({ name, rank, skill });
  renderRoster();
  log('Contratado ' + name + '.');
}

function dismissSoldier(i) {
  const s = game.soldiers.splice(i, 1)[0];
  renderRoster();
  log('Despedido ' + s.name + '.');
}

function createContract() {
  const name = prompt('Nombre del contrato:');
  if (!name) return;
  const risk = parseInt(prompt('Riesgo (1-100):', '50')) || 50;
  const reward = parseInt(prompt('Recompensa $:', '1000')) || 1000;
  game.contracts.push({ name, risk, reward });
  renderContracts();
  log('Nuevo contrato disponible: ' + name + '.');
}

function acceptContract(i) {
  const contract = game.contracts[i];
  if (game.soldiers.length === 0) {
    alert('No tienes soldados.');
    return;
  }
  const idx = parseInt(
    prompt('Índice del soldado asignado (0-' + (game.soldiers.length - 1) + '):')
  );
  if (isNaN(idx) || idx < 0 || idx >= game.soldiers.length) return;
  const soldier = game.soldiers[idx];
  const chance = Math.max(5, soldier.skill - contract.risk + 50);
  const roll = Math.random() * 100;
  if (roll < chance) {
    game.credits += contract.reward;
    game.reputation += 5;
    log(soldier.name + ' completó con éxito ' + contract.name + '.');
  } else {
    game.reputation -= 10;
    log(soldier.name + ' falló ' + contract.name + '.');
  }
  game.contracts.splice(i, 1);
  renderAll();
}

function renderAll() {
  renderInfo();
  renderRoster();
  renderContracts();
}

document.getElementById('newBtn').addEventListener('click', newGame);
document.getElementById('loadBtn').addEventListener('click', loadGame);
document.getElementById('saveBtn').addEventListener('click', saveGame);

renderAll();
</script>
</body>
</html>
